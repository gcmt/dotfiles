#!/usr/bin/env python

import os
import time
import argparse
from datetime import datetime
from subprocess import run


def notify(title, msg):
    run(['notify-send', title, msg])


def parse_args():
    parser = argparse.ArgumentParser(allow_abbrev=False)
    parser.add_argument('-wait', type=int, nargs='?', const=4)
    return parser.parse_known_args()


def main():

    args, import_args = parse_args()
    if args.wait:
        time.sleep(args.wait)

    now = datetime.utcnow()
    home = os.environ['HOME']
    dest = f"{home}/Downloads/Screenshot_{now.strftime('%Y-%m-%d-%T')}.png"

    run(['import'] + import_args + [dest])

    if args.wait:
        notify('Screenshot taken', dest.replace(home, '~', 1))


if __name__ == '__main__':
    main()
