#!/usr/bin/env python

import os
import sys
import time
from datetime import datetime
from subprocess import run

DEFAULT_DELAY = 4

def notify(title, msg):
    run(['notify-send', title, msg])

now = datetime.utcnow()
fname = f"Screenshot_{now.strftime('%Y-%m-%d-%T')}.png"
dest = os.path.join(os.environ['HOME'], 'Downloads', fname)

wait = '-wait' in sys.argv
if wait:
    i = sys.argv.index('-wait')
    try:
        seconds = int(sys.argv[i+1])
        sys.argv.pop(i+1)
    except (ValueError, IndexError):
        seconds = DEFAULT_DELAY
    sys.argv.pop(i)
    time.sleep(seconds)

sys.argv.pop(0)
run(['import'] + sys.argv + [dest])

if wait and '-window' in sys.argv:
    notify('Screenshot taken', dest)
