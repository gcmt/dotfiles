#!/bin/bash

opts="-dmenu -p 'Mark'"
opts+=" -kb-custom-1 'Control+a,Control+Return'"
opts+=" -theme 'main-light'"
opts+=" -theme-str 'window { width: 25%; }'"
opts+=" -theme-str 'listview { enabled: false; }'"
opts+=" -theme-str 'case-indicator { enabled: false; }'"
opts+=" -theme-str 'inputbar { padding: 0; }'"
opts+=" -theme-str 'entry { padding: 12; }'"
opts+=" -theme-str 'prompt { enabled: true; padding: 12; }'"
opts+=" -theme-str 'prompt { color: @prompt-color ; background-color: @prompt-background; }'"

mark="$(eval "rofi $opts")"
rofi_exit=$?

if (( rofi_exit == 1 )); then
	exit 1
fi

# strip whitespaces
mark="$(sed 's/\(\s\+$\|^\s\+\)//g' <<< "$mark")"

if [[ -z "$mark" ]]; then
	i3-msg "[con_id=\"__focused__\"] unmark"
else
	case $rofi_exit in
		10) i3-msg "mark --add \"$mark\"" ;;
		*) i3-msg "mark \"$mark\"" ;;
	esac
fi
