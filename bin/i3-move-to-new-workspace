#!/bin/bash

workspace_exists() {
	echo "$workspaces" | jq -e ".[] | select(.num==$1)" >/dev/null
}

main() {
	local num=1
	while (( num < 10 )); do
		if ! workspace_exists $num; then
			i3-msg "move container to workspace number $num" >/dev/null
			if (( follow == 1 )); then
				i3-msg "workspace number $num" >/dev/null
			fi
			break
		fi
		(( num += 1 ))
	done
}

workspaces=$(i3-msg -t get_workspaces)

follow=0
if [[ "$*" =~ -follow($| ) ]]; then
	follow=1
fi

main
