#!/bin/bash

current_workspace_name() {
	i3-msg -t get_workspaces \
		| jq '.[] | select(.focused==true).name' \
		| cut -d "\"" -f 2
}

style="-width 25"
style="$style -theme-str 'listview { enabled: false; }'"
style="$style -theme-str 'case-indicator { enabled: false; }'"
style="$style -theme-str 'prompt { enabled: true; }'"

# add a trailing space if the worksapce name is just a number
current=$(current_workspace_name)
[[ "$current" =~ ^[0-9]+$ ]] && current="$current "

options="-dmenu -p 'New name: ' -filter '$current' "

name=$(echo "" | eval "rofi $options $style" | sed 's/\(\s\+$\|^\s\+\)//g')
if [[ -z "$name" ]]; then
	exit 1
fi

i3-msg "rename workspace to \"$name\""
