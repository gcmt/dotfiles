# i3 config file (v4)

set $alt Mod1
set $cmd Mod4
set $mod Mod4

set $float_l resize set 90ppt 80ppt
set $float_m resize set 80ppt 70ppt
set $float_s resize set 70ppt 60ppt

# Options
# ----------------------------------------------------------------------------

font pango:Noto Sans Regular 10
floating_modifier $mod
focus_follows_mouse yes
workspace_auto_back_and_forth no
default_border normal 0
default_floating_border normal 0
default_orientation auto
workspace_layout stacking

gaps inner 5
gaps outer 1

# Rules
# ----------------------------------------------------------------------------

for_window [class="Pinentry"] floating enable
for_window [class="Qalculate"] floating enable
for_window [class="Ssh-askpass"] floating enable
for_window [class="KeepassXC"] layout stacking
for_window [class="git-cola"] layout stacking
for_window [class="Firefox" title="Library"] layout stacking

for_window [instance="urxvt-floating"] floating enable, $float_m, move position center

for_window [class=".*"] title_format " %title"
for_window [class="git-cola"] title_format " %title - Git Cola"
for_window [class="Firefox" instance="Places"] title_format " %title - Mozilla Firefox"

# Bindings
# ----------------------------------------------------------------------------

# Edit files
bindsym $mod+e exec --no-startup-id rofi-edit

# Shortcuts
bindsym $mod+i exec --no-startup-id i3-focus -c Firefox
bindsym $mod+apostrophe exec --no-startup-id "i3-focus -m _m,_mark,_marked"

# Open Fastmail
bindsym $mod+ograve exec --no-startup-id firefox -new-tab 'https://www.fastmail.com/mail/'

# Kill window
bindsym $mod+Shift+q kill
bindsym --release button3 kill

# Mark/unmark window
bindsym $mod+m exec --no-startup-id i3-mark
bindsym $mod+Shift+m [con_id="__focused__"] unmark

# Open tmux
bindsym $mod+u exec i3-t
bindsym $mod+plus exec i3-t scratch

# Pick tmux session
bindsym $mod+Control+u exec rofi-tmux

# Rename current workspace
bindsym $mod+comma exec --no-startup-id i3-rename-workspace
bindsym $mod+Shift+comma exec --no-startup-id i3-rename-workspace -r

# Create new workspace
bindsym $mod+w exec --no-startup-id i3-new-workspace

# Rofi bindings
bindsym $mod+Tab exec --no-startup-id i3-choose-window -no-inputbar
bindsym $mod+space exec --no-startup-id rofi -show drun
bindsym $alt+space exec --no-startup-id rofi -show run

# Choose workspace with rofi
bindsym $mod+g exec --no-startup-id i3-choose-workspace

# Toggle Polybar visibility
bindsym $mod+Return exec --no-startup-id polybar-toggle

# Enter fullscreen mode
bindsym $mod+Shift+Return fullscreen toggle

# Cycle through containers
bindsym $mod+o exec --no-startup-id i3-next-window -next
bindsym $mod+Shift+o exec --no-startup-id i3-next-window -prev

# Change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Horizontal layout, split vertically
bindsym $mod+b split vertical

# Vertical layout, split horizontally
bindsym $mod+r split horizontal

# Reset workspace layout
bindsym $mod+0 [workspace="__focused__"] move workspace "temp__"; [workspace="temp__"] move workspace current

# Change window layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+t layout tabbed
bindsym $mod+d layout toggle split

# Focus the parent or child container
bindsym $mod+period focus child
bindsym $mod+Shift+period focus parent

# Move container
bindsym $mod+c move position center
bindsym $mod+Shift+h move left 10px
bindsym $mod+Shift+j move down 10px
bindsym $mod+Shift+k move up 10px
bindsym $mod+Shift+l move right 10px

# Resize container
bindsym $mod+Left resize shrink left 5px or 2ppt
bindsym $mod+Down resize shrink down 5px or 2ppt
bindsym $mod+Up resize shrink up 5px or 2ppt
bindsym $mod+Right resize shrink right 5px or 2ppt
bindsym $mod+Shift+Left resize grow left 5px or 2ppt
bindsym $mod+Shift+Down resize grow down 5px or 2ppt
bindsym $mod+Shift+Up resize grow up 5px or 2ppt
bindsym $mod+Shift+Right resize grow right 5px or 2ppt

# Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9

# Move window to other workspace
bindsym $mod+Shift+1 move container to workspace number 1; workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2; workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3; workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4; workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5; workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6; workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7; workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8; workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9; workspace number 9

# Move window to new workspace and back
bindsym $mod+Shift+w exec --no-startup-id i3-move-container-to-new-workspace -f
bindsym $mod+Shift+e exec --no-startup-id i3-move-container-to-new-workspace
bindsym $mod+Shift+a move container to workspace back_and_forth; workspace back_and_forth

# Move to last focused workspace
bindsym $mod+a workspace back_and_forth

# Cycle through workspaces
bindsym $mod+n workspace next
bindsym $mod+p workspace prev

# Change focus between tiling / floating windows
bindsym $mod+z focus mode_toggle

# Scratchpad bindings
bindsym $mod+minus scratchpad show; floating disable
bindsym $mod+Control+minus scratchpad show; $float_m; move position center
bindsym $mod+Shift+minus move scratchpad

# Toggle tiling / floating
bindsym $mod+f floating toggle

mode "float" {

	bindsym l floating enable; $float_l; move position center
	bindsym m floating enable; $float_m; move position center
	bindsym s floating enable; $float_s; move position center

	bindsym plus floating enable; resize grow right 5px; resize grow down 4px; move position center
	bindsym minus floating enable; resize shrink right 5px; resize shrink down 4px; move position center

	bindsym q mode "default"
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
}

bindsym $mod+Shift+f mode "float"

# i3 commands
mode "i3" {

	bindsym r reload
	bindsym Shift+r restart
	bindsym Shift+x exit

	bindsym Shift+l exec --no-startup-id lock -mfb, mode "default"
	bindsym Shift+s exec --no-startup-id lock && sleep 1 && systemctl suspend, mode "default"

	bindsym c exec --no-startup-id urxvt -name urxvt-floating -e vim .config/i3/config; mode "default"

	bindsym q mode "default"
	bindsym Return mode "default"
	bindsym Escape mode "default"
	bindsym Control+c mode "default"
}

bindsym $mod+$alt+space mode "i3"

# Controls
# ----------------------------------------------------------------------------

# Music player
bindsym XF86AudioPlay exec --no-startup-id mpc toggle
bindsym XF86AudioNext exec --no-startup-id mpc next
bindsym XF86AudioPrev exec --no-startup-id mpc prev
bindsym $mod+XF86AudioPlay exec --no-startup-id urxvt -name urxvt-floating -e ncmpcpp
bindsym $mod+F5 exec --no-startup-id urxvt -name urxvt-floating -e ncmpcpp
bindsym $mod+F6 exec --no-startup-id mpc toggle
bindsym $mod+F7 exec --no-startup-id mpc prev
bindsym $mod+F8 exec --no-startup-id mpc next

# Screenshots (XF86LaunchA = F3)
bindsym XF86LaunchA exec --no-startup-id capture -window root
bindsym $mod+XF86LaunchA exec --no-startup-id capture
bindsym $alt+XF86LaunchA exec --no-startup-id capture -wait -window root
bindsym $alt+$mod+XF86LaunchA exec --no-startup-id capture -wait
bindsym $mod+F1 exec --no-startup-id capture -window root
bindsym $mod+F2 exec --no-startup-id capture
bindsym $mod+F3 exec --no-startup-id capture -wait -window root
bindsym $mod+F4 exec --no-startup-id capture -wait

# Volume controls
bindsym XF86AudioRaiseVolume exec --no-startup-id volume up
bindsym XF86AudioLowerVolume exec --no-startup-id volume down
bindsym XF86AudioMute exec --no-startup-id volume toggle
bindsym $mod+F12 exec --no-startup-id volume up
bindsym $mod+F11 exec --no-startup-id volume down
bindsym $mod+F10 exec --no-startup-id volume toggle

# Screen brightness controls
bindsym XF86MonBrightnessUp exec --no-startup-id xbacklight -inc 5
bindsym XF86MonBrightnessDown exec --no-startup-id xbacklight -dec 5

# Keyboard backlight controls
bindsym XF86KbdBrightnessUp exec --no-startup-id xbacklight -ctrl smc::kbd_backlight -inc 5
bindsym XF86KbdBrightnessDown exec --no-startup-id xbacklight -ctrl smc::kbd_backlight -dec 5

# Timer
bindsym XF86LaunchB exec --no-startup-id timer toggle 45m

# Dark Colors
# ----------------------------------------------------------------------------

# class                 border   back     text     indic    child_border
# client.focused          #1e222b  #3a3e4a  #8e9299  #3ba7f9  #3c74b7
# client.focused_inactive #1e222b  #3a3e4a  #8e9299  #484e50  #5f676a
# client.unfocused        #1e222b  #252933  #8e9299  #292d2e  #3a3e4a
# client.urgent           #1e222b  #252933  #945F65  #900000  #900000
# client.placeholder      #1e222b  #252933  #8e9299  #000000  #0c0c0c

# client.background       #1e222b

# Light Colors
# ----------------------------------------------------------------------------

# class                 border   back     text     indic    child_border
client.focused          #c2c7ce  #c2c7ce  #52565e  #f95467  #c2c7ce
client.focused_inactive #e7e8eb  #e7e8eb  #9fa2a8  #f95467  #e7e8eb
client.unfocused        #e7e8eb  #e7e8eb  #9fa2a8  #f95467  #e7e8eb
client.urgent           #ce7d86  #ce7d86  #cdd1d6  #ce7d86  #e7e8eb
client.placeholder      #e7e8eb  #e7e8eb  #8e9299  #ce7d86  #e7e8eb

client.background       #e7e8eb

# Status Bar
# ----------------------------------------------------------------------------

bar {
	i3bar_command $HOME/.config/polybar/start.sh
}
